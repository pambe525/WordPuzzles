{% extends "base.html" %}
{% load static %}
{% block content %}
    <div class="page-title">My Puzzles</div>
    <hr class="dark-line">

    <!-- Tabs -->
    <nav class="nav-tabs">
        <ul>
            <li id="drafts-tab" class="active">Drafts</li>
            <li id="scheduled-tab">Scheduled</li>
            <li id="published-tab">Published</li>
        </ul>
    </nav>

    <!-- Draft Puzzles tab content -->
    <div class="tab-content active-tab drafts-tab">
{#        {% if draft_puzzles|length == 0 %}#}
{#            <div>No draft puzzles.</div>#}
{#        {% else %}#}
{#            {% for draft in draft_puzzles %}#}
{#            <div class="list-badge">#}
{#                {% if draft.type == 0 %}#}
{#                    <img class="thumbnail" src="{% static '/images/non-cryptic-clues.png' %}" alt="Non-cryptic Clues"/>#}
{#                {% else %}#}
{#                    <img class="thumbnail" src="{% static '/images/cryptic-clues.jpg' %}" alt="Cryptic Clues"/>#}
{#                {% endif %}#}
{#                <div>#}
{#                    <a href="{% url 'edit_puzzle' draft.id %}" class="bold-text">{{ draft }}</a>#}
{#                    <div class="small-text">Last edited on {{ draft.modified_at }}</div>#}
{#                </div>#}
{#                <div class="icon-group r-float"><i class="fa-regular fa-trash-can" title="Delete"></i></div>#}
{#            </div>#}
{#            {% endfor %}#}
{#        {% endif %}#}
        <button id="btnNewPuzzle" class="blue-btn m-top">New Puzzle</button>
    </div>

    <!-- Scheduled Puzzles tab content -->
    <div class="tab-content scheduled-tab">
        <div class="subtitle">My Scheduled Puzzles</div>
        <div class="notetext">Puzzles scheduled for a live session</div>
    </div>

    <!-- Published Puzzles tab content -->
    <div class="tab-content published-tab">
        <div class="subtitle">My Published Puzzles</div>
    </div>

    <!-- New Puzzle Dialog -->
    <dialog class="modal-dialog" id="new-puzzle-dialog">
        <div class="subtitle">New Puzzle</div>
        <hr>
        <form action="{% url 'new_puzzle' %}" method="post">
            {% csrf_token %}
            <table>{{ form.as_table }}</table>
            <button type="submit" class="blue-btn">Create Puzzle</button>
            <button id="btnClose" formmethod="dialog">Cancel</button>
        </form>
    </dialog>

    <script>
        const draftPuzzles = {{ draft_puzzles | safe }};
        const imgDirPath = "{% static '/images/' %}";
        const baseUrl = "{{ request.get_host }}/edit_puzzle";

        function pageInit() {
            document.querySelectorAll(".nav-tabs li").forEach(tab => {
                tab.addEventListener('click', (event) => { activateTab(event); });
            });
            function activateTab(event) {
                document.querySelector(".nav-tabs li.active").classList.remove("active");
                document.querySelector(".tab-content.active-tab").classList.remove("active-tab");
                event.target.classList.add("active");
                document.querySelector("." + event.target.id).classList.add("active-tab");
            }
            bindModalDialogToButton("new-puzzle-dialog", "btnNewPuzzle");
            console.log(draftPuzzles);
        }
    </script>
{% endblock %}